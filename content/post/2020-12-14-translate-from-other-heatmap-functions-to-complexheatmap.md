---
title: "Translate from other heatmap functions to ComplexHeatmap"
date: 2020-12-14
author: Zuguang Gu
---



In my previous post ["Translate from pheatmap to
ComplexHeatmap"](../../2020/05/06/translate-from-pheatmap-to-complexheatmap/),
I introduced a `ComplexHeatmap::pheatmap()` which smoothly executes
`pheatmap::pheatmap()` code without any problem. With the newly developed
[**InteractiveComplexHeatmap**
package](https://github.com/jokergoo/InteractiveComplexHeatmap), the output of
`pheatmap()` can be directly exported as an interactive Shiny app.

```r
library(ComplexHeatmap)
ht = pheatmap(...)
library(InteractiveComplexHeatmap)
ht_shiny(ht)
```

To facilitate the users who are still using `heatmap()` and `heatmap.2()`
functions, to make the output of these two functions can be exported as interactive Shiny
apps as well, I implemented two similar translation functions
`ComplexHeatmap::heatmap()` and `ComplexHeatmap::heatmap.2()` which use the
same set of arguments as the original functions and generate almost identical
plots.

Some arguments in the two original functions are ignored in the
**ComplexHeatmap** implementation, but there won't be any error thrown out.

Then with `ComplexHeatmap::heatmap()` and `ComplexHeatmap::heatmap.2()`, you
can make your old heatmaps interactive by:

```r
library(ComplexHeatmap)
ht = heatmap(...) # or ht = heatmap.2(...)
library(InteractiveComplexHeatmap)
ht_shiny(ht)
```

To replace the two original functions with `ComplexHeatmap::heatmap()` and
`ComplexHeatmap::heatmap.2()`, we need to make sure the new homonymous
functions generates the same plots as the old ones. In the following examples,
`compare_heatmap()` basically sends all the arguments to `stats::heatmap()`
and `ComplexHeatmap::heatmap()` separately and you can directly compare the
two plots generated by the two functions.


``` r
library(ComplexHeatmap)
```

## Translate from `stats::heatmap()`


``` r
x  = as.matrix(mtcars)
rc = rainbow(nrow(x), start = 0, end = 0.3)
cc = rainbow(ncol(x), start = 0, end = 0.3)
compare_heatmap(x, col = cm.colors(256), scale = "column",
              RowSideColors = rc, ColSideColors = cc, margins = c(5,10),
              xlab = "specification variables", ylab =  "Car Models",
              main = "heatmap(<Mtcars data>, ..., scale = \"column\")")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap(x, Colv = NA, col = cm.colors(256), scale = "column",
        RowSideColors = rc, margins = c(5,10),
        xlab = "specification variables", ylab =  "Car Models",
        main = "heatmap(<Mtcars data>, ..., scale = \"column\")")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap(x, Rowv = NA, Colv = NA, scale = "column",
        main = "heatmap(*, NA, NA) ~= image(t(x))")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;" />


``` r
Ca = cor(attitude)
cc = rainbow(nrow(Ca))
compare_heatmap(Ca, Rowv = FALSE, RowSideColors = cc, ColSideColors = cc)
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" />


``` r
cU = cor(USJudgeRatings)
compare_heatmap(cU, Rowv = FALSE, col = topo.colors(16),
             distfun = function(c) as.dist(1 - c), keep.dendro = TRUE)
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;" />


## Translate from `gplots::heatmap.2()`

Similarly, in the following examples, `compare_heatmap.2()` basically sends
all the arguments to `gplots::heatmap.2()` and `ComplexHeatmap::heatmap.2()`
separately.


``` r
data(mtcars)
x = as.matrix(mtcars)
rc = rainbow(nrow(x), start = 0, end = .3)
cc = rainbow(ncol(x), start = 0, end = .3)
compare_heatmap.2(x)
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, dendrogram = "none")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, dendrogram = "row")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, dendrogram = "col")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;" />



``` r
compare_heatmap.2(x, Rowv = FALSE, dendrogram = "both")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, Rowv = NULL, dendrogram = "both")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, Colv = FALSE, dendrogram = "both")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, reorderfun = function(d, w) reorder(d, w, agglo.FUN = mean))
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;" />




``` r
compare_heatmap.2(x, col = gplots::bluered, scale = "column", tracecol = "#303030")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;" />


``` r
compare_heatmap.2(x, col = cm.colors(255), scale = "column",
         RowSideColors = rc, ColSideColors = cc, margin = c(5, 10),
         xlab = "specification variables", ylab = "Car Models",
         main = "heatmap(<Mtcars data>, ..., scale=\"column\")",
         tracecol = "green", density = "density")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;" />



``` r
compare_heatmap.2(x, col = cm.colors(255), scale = "column",
         RowSideColors = rc, ColSideColors = cc, margin = c(5, 10),
         xlab = "specification variables", ylab = "Car Models",
         main = "heatmap(<Mtcars data>, ..., scale=\"column\")",
         tracecol = "green", density = "density", colRow = rc, colCol = cc,
         srtCol = 45, adjCol = c(0.5,1))
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;" />


``` r
data(attitude)
Ca = cor(attitude)

compare_heatmap.2(Ca, symm = TRUE, margin = c(6, 6), trace = "none" )
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;" />



``` r
compare_heatmap.2(Ca, Rowv = FALSE, symm = TRUE, margin = c(6, 6), trace = "none" )
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;" />



``` r
data(USJudgeRatings)
cU = cor(USJudgeRatings)

compare_heatmap.2(cU, Rowv = FALSE, symm = TRUE, col = topo.colors(16),
              distfun = function(c) as.dist(1 - c), trace = "none")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-21-1.png" width="960" style="display: block; margin: auto;" />


``` r
hM = format(round(cU, 2))
compare_heatmap.2(cU, Rowv = FALSE, symm = TRUE, col = rev(heat.colors(16)),
             distfun = function(c) as.dist(1 - c), trace = "none",
             cellnote = hM)
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-22-1.png" width="960" style="display: block; margin: auto;" />


``` r
library(affy)
data(SpikeIn)
pms = SpikeIn@pm

compare_heatmap.2(pms, col = rev(heat.colors(16)), main = "SpikeIn@pm",
              xlab = "Relative Concentration", ylab = "Probeset",
              scale = "row")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto;" />


``` r
data = pms / pms[, "12.50"]
data = ifelse(data > 1, data, -1 / data)
compare_heatmap.2(data, breaks = 16, col = gplots::redgreen, tracecol = "blue",
               main = "SpikeIn@pm Fold Changes\nrelative to 12.50 sample",
               xlab = "Relative Concentration", ylab = "Probeset")
```

<img src="/lab-cn/post/2020-12-14-translate-from-other-heatmap-functions-to-complexheatmap_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;" />

## SessionInfo


``` r
sessionInfo()
```

```
## R version 4.4.2 (2024-10-31)
## Platform: aarch64-apple-darwin20
## Running under: macOS 26.0.1
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] C.UTF-8/UTF-8/C.UTF-8/C/C.UTF-8/C.UTF-8
## 
## time zone: Europe/Berlin
## tzcode source: internal
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] affy_1.84.0           Biobase_2.66.0        BiocGenerics_0.52.0   ComplexHeatmap_2.25.2
## [5] knitr_1.50            colorout_1.3-2       
## 
## loaded via a namespace (and not attached):
##  [1] sass_0.4.9            gplots_3.2.0          bitops_1.0-9          KernSmooth_2.23-24   
##  [5] shape_1.4.6.1         gtools_3.9.5          blogdown_1.19         digest_0.6.37        
##  [9] magrittr_2.0.3        caTools_1.18.3        evaluate_1.0.3        RColorBrewer_1.1-3   
## [13] bookdown_0.44         iterators_1.0.14      circlize_0.4.16       fastmap_1.2.0        
## [17] foreach_1.5.2         doParallel_1.0.17     jsonlite_1.9.0        GlobalOptions_0.1.2  
## [21] BiocManager_1.30.25   preprocessCore_1.68.0 codetools_0.2-20      jquerylib_0.1.4      
## [25] cli_3.6.4             rlang_1.1.5           crayon_1.5.3          cachem_1.1.0         
## [29] yaml_2.3.10           tools_4.4.2           parallel_4.4.2        colorspace_2.1-1     
## [33] GetoptLong_1.0.5      R6_2.6.1              png_0.1-8             gridGraphics_0.5-1   
## [37] matrixStats_1.5.0     stats4_4.4.2          lifecycle_1.0.4       magick_2.8.5         
## [41] zlibbioc_1.52.0       S4Vectors_0.44.0      IRanges_2.40.1        clue_0.3-66          
## [45] cluster_2.1.6         affyio_1.76.0         bslib_0.9.0           Rcpp_1.0.14          
## [49] xfun_0.51             rjson_0.2.23          htmltools_0.5.8.1     rmarkdown_2.29       
## [53] Cairo_1.6-2           compiler_4.4.2
```

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
  $(document).ready(function(){
  $("img").css("display", "inline");
  $("main.content").css("max-width", "1000px");
});
</script>

